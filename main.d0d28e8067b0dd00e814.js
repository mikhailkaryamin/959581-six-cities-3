!function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(u&&u(t);m.length;)m.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,i=1;i<r.length;i++){var c=r[i];0!==s[c]&&(a=!1)}a&&(n.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},s={0:0},n=[];function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="https://mikhailkaryamin.github.io/959581-six-cities-3/";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;n.push([52,1]),r()}([,function(e,t,r){"use strict";const a={DATA:"DATA",CITY:"CITY",OFFER:"OFFER",SORT:"SORT",USER:"USER",FAVORITE:"FAVORITE",RESPONSE:"RESPONSE"};t.a=a},function(e,t,r){"use strict";r.r(t),r.d(t,"extend",(function(){return a})),r.d(t,"getUniqueArray",(function(){return s}));const a=(e,t)=>Object.assign({},e,t),s=e=>{const t=new Set(e);return Array.from(t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"MS_IN_WEEK",(function(){return l})),r.d(t,"SORTING",(function(){return n})),r.d(t,"ONE_STAR",(function(){return u})),r.d(t,"STARS",(function(){return d})),r.d(t,"SITE_URL",(function(){return m})),r.d(t,"ResponseStatus",(function(){return c})),r.d(t,"AppRoute",(function(){return a})),r.d(t,"TypeSort",(function(){return o})),r.d(t,"ClassModificator",(function(){return s})),r.d(t,"TypeInputLogin",(function(){return i})),r.d(t,"MAX_SHOW_COMMENTS",(function(){return p}));const a={ROOT:"/",OFFER:"/offer/:id",LOGIN:"/login",FAVORITE:"/favorite/",NOT_FOUND:"/*"},s={CITIES:"cities",CITIES_MAP:"cities__map",CITIES_PLACES:"cities__places",CITIES_PLACES_LIST:"cities__places-list tabs__content",PROPERTY_MAP:"property__map",PROPERTY:"property",PLACE_CARD:"place-card",NEAR_PLACES:"near-places",NEAR_PLACES_LIST:"near-places__list",FAVORITES:"favorites",PAGE_MAIN:"page--gray page--main",PAGE_LOGIN:"page--gray page--login",PAGE_PROPERTY:"page__main--property"},n=["Popular","Price: low to high","Price: high to low","Top rated first"],o={POPULAR:"Popular",PRICE_LOW_TO_HIGH:"Price: low to high",PRICE_HIGH_TO_LOW:"Price: high to low",TOP_RATED_FIRST:"Top rated first"},i={EMAIL:"email",PASSWORD:"password"},c={STATUS_OK:200,UNAUTHORIZED:401},l=6048e5,u=20,d=[5,4,3,2,1],m="https://htmlacademy-react-3.appspot.com/six-cities",p=10},,,,function(e,t,r){"use strict";r.r(t);var a=r(2),s=r(16),n=r(3);class o{constructor(e){this.id=e.id,this.email=e.email,this.name=e.name,this.avatarUrl=e.avatar_url,this.isPro=e.is_pro}static parseUser(e){return new o(e)}}var i=o;r.d(t,"ActionCreator",(function(){return m})),r.d(t,"ActionType",(function(){return d})),r.d(t,"reducer",(function(){return _})),r.d(t,"AuthorizationStatus",(function(){return l})),r.d(t,"Operation",(function(){return f})),r.d(t,"DEFAULT_USER",(function(){return c}));const c={id:-1,name:"",email:"",isPro:!1,avatarUrl:""},l={AUTH:"AUTH",NO_AUTH:"NO_AUTH"},u={authorizationStatus:l.NO_AUTH,user:c},d={REQUIRED_AUTHORIZATION:"REQUIRED_AUTHORIZATION",SET_USER:"SET_USER"},m={requireAuthorization:e=>({type:d.REQUIRED_AUTHORIZATION,payload:e}),setUser:e=>({type:d.SET_USER,payload:e})},p=(e,t)=>{const r=i.parseUser(e.data);t(m.requireAuthorization(l.AUTH)),t(m.setUser(r))},_=(e=u,t)=>{switch(t.type){case d.REQUIRED_AUTHORIZATION:return Object(a.extend)(e,{authorizationStatus:t.payload});case d.SET_USER:return Object(a.extend)(e,{user:t.payload})}return e},f={checkAuth:()=>(e,t,r)=>r.get("/login").then(t=>{p(t,e)}).catch(e=>{throw e}),signIn:e=>(t,r,a)=>a.post("/login",{email:e.login,password:e.password}).then(e=>{const r=e.status;t(s.ActionCreator.setResponseStatusCode(r)),r===n.ResponseStatus.STATUS_OK&&p(e,t)})}},,,,function(e,t,r){"use strict";class a{constructor(e){this.bedrooms=e.bedrooms,this.city=e.city,this.description=e.description,this.goods=e.goods,this.host={avatarUrl:e.host.avatar_url,id:e.host.id,isPro:e.host.is_pro,name:e.host.name},this.id=e.id,this.images=e.images,this.isFavorite=e.is_favorite,this.isPremium=e.is_premium,this.location=e.location,this.maxAdults=e.max_adults,this.previewImage=e.preview_image,this.price=e.price,this.rating=e.rating,this.title=e.title,this.type=e.type}toRAW(){return{bedrooms:this.bedrooms,city:this.city,description:this.description,goods:this.goods,host:{avatar_url:this.host.avatarUrl,id:this.host.id,is_pro:this.host.isPro,name:this.host.name},id:this.id,images:this.images,is_favorite:this.isFavorite,is_premium:this.isPremium,location:this.location,max_adults:this.maxAdults,preview_image:this.previewImage,price:this.price,rating:this.rating,title:this.title,type:this.type}}static parseOffer(e){return new a(e)}static parseOffers(e){return e.map(a.parseOffer)}}t.a=a},function(e,t,r){"use strict";r.r(t),r.d(t,"getAuthorizationStatus",(function(){return s})),r.d(t,"getUser",(function(){return n}));const a=r(1).a.USER,s=e=>e[a].authorizationStatus,n=e=>e[a].user},,,,function(e,t,r){"use strict";r.r(t),r.d(t,"reducer",(function(){return i})),r.d(t,"ActionCreator",(function(){return o})),r.d(t,"ActionType",(function(){return n}));var a=r(2);const s={responseStatusCode:null},n={SET_RESPONSE_STATUS_CODE:"SET_RESPONSE_STATUS_CODE",RESET_RESPONSE_STATUS_CODE:"RESET_RESPONSE_STATUS_CODE"},o={setResponseStatusCode:e=>({type:n.SET_RESPONSE_STATUS_CODE,payload:e}),resetResponseStatusCode:()=>({type:n.RESET_RESPONSE_STATUS_CODE,payload:null})},i=(e=s,t)=>{switch(t.type){case n.SET_RESPONSE_STATUS_CODE:case n.RESET_RESPONSE_STATUS_CODE:return Object(a.extend)(e,{responseStatusCode:t.payload})}return e}},function(e,t,r){"use strict";r.r(t),r.d(t,"reducer",(function(){return i})),r.d(t,"ActionCreator",(function(){return o})),r.d(t,"ActionType",(function(){return n}));var a=r(2);const s={currentCity:""},n={SET_CURRENT_CITY:"SET_CURRENT_CITY"},o={setCurrentCity:e=>({type:n.SET_CURRENT_CITY,payload:e})},i=(e=s,t)=>{switch(t.type){case n.SET_CURRENT_CITY:return Object(a.extend)(e,{currentCity:t.payload})}return e}},,,function(e,t,r){"use strict";r.r(t),r.d(t,"reducer",(function(){return i})),r.d(t,"ActionCreator",(function(){return o})),r.d(t,"ActionType",(function(){return n}));var a=r(2);const s={activeOffer:null,focusOffer:null},n={SET_ACTIVE_OFFER:"SET_ACTIVE_OFFER",SET_FOCUS_OFFER:"SET_FOCUS_OFFER",RESET_FOCUS_OFFER:"RESET_FOCUS_OFFER"},o={setActiveOffer:e=>({type:n.SET_ACTIVE_OFFER,payload:e}),setFocusOffer:e=>({type:n.SET_FOCUS_OFFER,payload:e}),resetFocusOffer:()=>({type:n.RESET_FOCUS_OFFER,payload:null})},i=(e=s,t)=>{switch(t.type){case n.SET_ACTIVE_OFFER:return Object(a.extend)(e,{activeOffer:t.payload});case n.SET_FOCUS_OFFER:case n.RESET_FOCUS_OFFER:return Object(a.extend)(e,{focusOffer:t.payload})}return e}},function(e,t,r){"use strict";r.r(t);var a=r(2),s=r(1);class n{constructor(e){this.comment=e.comment,this.date=e.date,this.id=e.id,this.rating=e.rating,this.user={avatarUrl:e.user.avatar_url,id:e.user.id,isPro:e.user.is_pro,name:e.user.name}}toRAW(){return{comment:this.comment,date:this.date,id:this.id,rating:this.rating,user:{avatar_url:this.user.avatarUrl,id:this.user.id,is_pro:this.user.isPro,name:this.user.name}}}static parseComment(e){return new n(e)}static parseComments(e){return e.map(n.parseComment)}}var o=n,i=r(11),c=r(17);r.d(t,"reducer",(function(){return p})),r.d(t,"ActionType",(function(){return u})),r.d(t,"ActionCreator",(function(){return d})),r.d(t,"Operation",(function(){return m}));const l={offers:[],comments:[],offersNearby:[],loadStatus:!1},u={LOAD_OFFERS:"LOAD_OFFERS",LOAD_OFFERS_NEARBY:"LOAD_OFFERS_NEARBY",LOAD_COMMENTS:"LOAD_COMMENTS",LOAD_STATUS:"LOAD_STATUS",UPLOAD_COMMENTS:"UPLOAD_COMMENTS"},d={loadOffers:e=>({type:u.LOAD_OFFERS,payload:e}),loadOffersNearby:e=>({type:u.LOAD_OFFERS_NEARBY,payload:e}),loadComments:e=>({type:u.LOAD_COMMENTS,payload:e}),loadStatus:()=>({type:u.LOAD_STATUS,payload:!0}),uploadComments:e=>({type:u.UPLOAD_COMMENTS,payload:e})},m={loadOffers:()=>(e,t,r)=>r.get("/hotels").then(t=>{const r=i.a.parseOffers(t.data);e(d.loadOffers(r)),e(d.loadStatus()),0!==r.length&&e(c.ActionCreator.setCurrentCity(r[0].city.name))}),loadOffersNearby:()=>(e,t,r)=>{const a=`/hotels/${t()[s.a.OFFER].activeOffer.id}/nearby`;return r.get(a).then(t=>{const r=i.a.parseOffers(t.data);e(d.loadOffersNearby(r))})},loadComments:()=>(e,t,r)=>{const a=`/comments/${t()[s.a.OFFER].activeOffer.id}`;return r.get(a).then(t=>{const r=o.parseComments(t.data);e(d.loadComments(r))})},uploadComments:e=>(t,r,a)=>{const n=`/comments/${r()[s.a.OFFER].activeOffer.id}`;return a.post(n,{rating:e.rating,comment:e.text}).then(e=>{const r=o.parseComments(e.data);t(d.uploadComments(r))})}},p=(e=l,t)=>{switch(t.type){case u.LOAD_OFFERS:return Object(a.extend)(e,{offers:t.payload});case u.LOAD_COMMENTS:return Object(a.extend)(e,{comments:t.payload});case u.LOAD_OFFERS_NEARBY:return Object(a.extend)(e,{offersNearby:t.payload});case u.LOAD_STATUS:return Object(a.extend)(e,{loadStatus:t.payload});case u.UPLOAD_COMMENTS:return Object(a.extend)(e,{comments:t.payload})}return e}},,,function(e,t,r){"use strict";r.r(t),r.d(t,"getOffers",(function(){return l})),r.d(t,"getOffersNearby",(function(){return u})),r.d(t,"getLocations",(function(){return m})),r.d(t,"getOffersCurrentCity",(function(){return p})),r.d(t,"getLoadStatus",(function(){return d})),r.d(t,"getCommentsByShow",(function(){return f})),r.d(t,"getCountComments",(function(){return h}));var a=r(10),s=r(2),n=r(3),o=r(1);const i=o.a.DATA,c=e=>e[i].comments,l=e=>e[i].offers,u=e=>e[i].offersNearby,d=e=>e[i].loadStatus,m=Object(a.a)(l,e=>{const t=e.map(e=>e.city.name);return Object(s.getUniqueArray)(t)}),p=Object(a.a)(l,e=>e[o.a.CITY].currentCity,(e,t)=>e.filter(e=>e.city.name===t)),_=Object(a.a)(c,e=>e.slice((e,t)=>new Date(t.date)-new Date(e.date))),f=Object(a.a)(_,e=>e.slice(0,n.MAX_SHOW_COMMENTS)),h=Object(a.a)(c,e=>e.length)},function(e,t,r){"use strict";r.r(t),r.d(t,"getActiveOffer",(function(){return s})),r.d(t,"getFocusOffer",(function(){return n}));const a=r(1).a.OFFER,s=e=>e[a].activeOffer,n=e=>e[a].focusOffer},function(e,t,r){"use strict";r.r(t),r.d(t,"reducer",(function(){return u})),r.d(t,"Operation",(function(){return l})),r.d(t,"ActionType",(function(){return i})),r.d(t,"ActionCreator",(function(){return c}));var a=r(2),s=r(11),n=r(1);const o={favorites:[]},i={ADD_FAVORITE:"ADD_FAVORITE",LOAD_FAVORITES:"LOAD_FAVORITES",REMOVE_FAVORITE:"REMOVE_FAVORITE"},c={addFavorite:e=>({type:i.ADD_FAVORITE,payload:e}),loadFavorites:e=>({type:i.LOAD_FAVORITES,payload:e}),removeFavorite:e=>({type:i.REMOVE_FAVORITE,payload:e})},l={addFavorite:()=>(e,t,r)=>{let a;return a=null!==t()[n.a.OFFER].focusOffer?t()[n.a.OFFER].focusOffer.id:t()[n.a.OFFER].activeOffer.id,r.post(`/favorite/${a}/0.5`,{hotel_id:a,status:.5}).then(t=>{const r=s.a.parseOffer(t.data);e(c.addFavorite(r))})},loadFavorites:()=>(e,t,r)=>r.get("/favorite").then(t=>{const r=s.a.parseOffers(t.data);e(c.loadFavorites(r))}),removeFavorite:()=>(e,t,r)=>{let a;return a=null!==t()[n.a.OFFER].focusOffer?t()[n.a.OFFER].focusOffer.id:t()[n.a.OFFER].activeOffer.id,r.post(`/favorite/${a}/0`,{hotel_id:a,status:0}).then(t=>{const r=s.a.parseOffer(t.data);e(c.removeFavorite(r))})}},u=(e=o,t)=>{switch(t.type){case i.LOAD_FAVORITES:return Object(a.extend)(e,{favorites:t.payload});case i.ADD_FAVORITE:return Object(a.extend)(e,{favorites:[t.payload,...e.favorites]});case i.REMOVE_FAVORITE:return Object(a.extend)(e,{favorites:e.favorites.filter(e=>e.id!==t.payload.id)});default:return e}}},function(e,t,r){"use strict";r.r(t),r.d(t,"reducer",(function(){return i})),r.d(t,"ActionCreator",(function(){return o})),r.d(t,"ActionType",(function(){return n}));var a=r(2);const s={currentSort:r(3).TypeSort.POPULAR},n={SET_CURRENT_SORT:"SET_CURRENT_SORT"},o={setCurrentSort:e=>({type:n.SET_CURRENT_SORT,payload:e})},i=(e=s,t)=>{switch(t.type){case n.SET_CURRENT_SORT:return Object(a.extend)(e,{currentSort:t.payload})}return e}},,,,,,function(e,t,r){"use strict";r.r(t),r.d(t,"checkFavorite",(function(){return c})),r.d(t,"getFavorites",(function(){return i})),r.d(t,"getFavoritesLocations",(function(){return l}));var a=r(1),s=r(10),n=r(2);const o=a.a.FAVORITE,i=e=>e[o].favorites,c=(e,t)=>e[o].favorites.some(e=>e.id===t),l=Object(s.a)(i,e=>Object(n.getUniqueArray)(e.map(e=>e.city.name)))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(71);t.default=e=>{const{className:t,children:r,isAuth:n,user:o}=e;return a.createElement("div",{className:`page ${t}`},a.createElement(s.default,{isAuth:n,user:o}),r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(3),o=r(36),i=r(37);t.default=e=>{const{classModificator:t,offer:r,onMouseEnter:c,onMouseLeave:l}=e,{id:u,isPremium:d,previewImage:m,price:p,rating:_,title:f,type:h}=r;return a.createElement("article",{className:`${t}__place-card place-card`,onMouseEnter:()=>{c(r)},onMouseLeave:()=>{l()}},d&&t!==n.ClassModificator.FAVORITES&&a.createElement("div",{className:"place-card__mark"},a.createElement("span",null,"Premium")),a.createElement("div",{className:"cities__image-wrapper place-card__image-wrapper"},a.createElement("a",{href:"#"},a.createElement("img",{className:"place-card__image",src:m,width:t===n.ClassModificator.FAVORITES?150:260,height:t===n.ClassModificator.FAVORITES?110:200,alt:"Place image"}))),a.createElement("div",{className:"place-card__info"},a.createElement("div",{className:"place-card__price-wrapper"},a.createElement("div",{className:"place-card__price"},a.createElement("b",{className:"place-card__price-value"},"€",p),a.createElement("span",{className:"place-card__price-text"},"/ night")),a.createElement(o.default,{classModificator:t,id:u,height:19,width:18})),a.createElement(i.default,{classModificator:n.ClassModificator.PLACE_CARD,rating:_}),a.createElement("h2",{className:"place-card__name"},a.createElement(s.Link,{to:`/offer/${u}`},f)),a.createElement("p",{className:"place-card__type"},h)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(8),o=r(26),i=r(7),c=r(12),l=r(33),u=r(3);class d extends a.PureComponent{constructor(e){super(e),this._handleFavorite=this._handleFavorite.bind(this)}_handleFavorite(){const{id:e,isFavorite:t,onFavoriteClick:r}=this.props;r(e,t)}render(){const{authStatus:e,classModificator:t,isFavorite:r,height:n,width:o}=this.props,c=e===i.AuthorizationStatus.AUTH,l=r?"place-card__bookmark-button--active":"";return a.createElement(a.Fragment,null,c&&a.createElement("button",{className:`${t}__bookmark-button button ${l}`,type:"button",onClick:this._handleFavorite},a.createElement("svg",{className:"place-card__bookmark-icon",width:o,height:n},a.createElement("use",{xlinkHref:"#icon-bookmark"})),a.createElement("span",{className:"visually-hidden"},"To bookmarks")),c||a.createElement(s.Link,{to:u.AppRoute.LOGIN,className:`${t}__bookmark-button button`},a.createElement("svg",{className:"place-card__bookmark-icon",width:o,height:n},a.createElement("use",{xlinkHref:"#icon-bookmark"})),a.createElement("span",{className:"visually-hidden"},"To bookmarks")))}}t.FavoriteButton=d;t.default=n.connect((e,t)=>({authStatus:c.getAuthorizationStatus(e),isFavorite:l.checkFavorite(e,t.id)}),e=>({onFavoriteClick(t,r){e(r?o.Operation.removeFavorite(t):o.Operation.addFavorite(t))}}))(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3);t.default=e=>{const{classModificator:t,rating:r}=e,n=Math.round(r)*s.ONE_STAR;return a.createElement("div",{className:`${t}__rating rating`},a.createElement("div",{className:`${t}__stars rating__stars`},a.createElement("span",{style:{width:`${n}%`}}),a.createElement("span",{className:"visually-hidden"},"Rating")),t===s.ClassModificator.PROPERTY&&a.createElement("span",{className:`${t}__rating-value rating__value`},r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=e=>{class t extends a.PureComponent{constructor(e){super(e),this.state={isHovered:!1},this._handleMouseEnter=this._handleMouseEnter.bind(this),this._handleMouseLeave=this._handleMouseLeave.bind(this)}_handleMouseEnter(e){this.setState({isHovered:!0}),this.props.onCardHover(e)}_handleMouseLeave(){this.setState({isHovered:!1}),this.props.onCardLeave()}render(){return a.createElement(e,Object.assign({},this.props,{onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave}))}}return t}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(82),n=r(3);class o extends a.PureComponent{constructor(t){super(t),this._mapRef=a.createRef(),this._map=void 0,this._markers={},this._iconActive=s.icon({iconUrl:`${e.env.PUBLIC_URL+"/img/pin-active.svg"}`,iconSize:[30,35]}),this._iconDefault=s.icon({iconUrl:`${e.env.PUBLIC_URL+"/img/pin.svg"}`,iconSize:[30,35]}),this._iconCurrentOffer=s.icon({iconUrl:`${e.env.PUBLIC_URL+"/img/pin-current-offer.svg"}`,iconSize:[37,42]})}componentDidMount(){if(this._mapRef.current){const{currentCityOffers:e,classModificator:t,currentOfferCoordinate:r}=this.props,a=this._getCoordinates(e);this._initiatesMap(),s.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">\n          OpenStreetMap</a> contributors &copy;\n          <a href="https://carto.com/attributions">CARTO</a>'}).addTo(this._map),this._markers=a.map(e=>s.marker(e,{icon:this._iconDefault}).addTo(this._map)),t===n.ClassModificator.PROPERTY_MAP&&this._markers.push(s.marker(r,{icon:this._iconCurrentOffer}).addTo(this._map))}}componentDidUpdate(){const{focusOffer:e,currentCityOffers:t,classModificator:r,currentOfferCoordinate:a}=this.props,o=this._getCurrentCityCoordinate(t);if(this._map.setView(o,o.zoom),this._resetMarkers(),null!==e){const r=this._getCoordinatesWithID(t),a=e.id;this._markers=r.map(e=>e.id!==a?s.marker(e,{icon:this._iconDefault}).addTo(this._map):s.marker(e,{icon:this._iconActive}).addTo(this._map))}else if(null===e){const e=this._getCoordinates(t);this._markers=e.map(e=>s.marker(e,{icon:this._iconDefault}).addTo(this._map))}r===n.ClassModificator.PROPERTY_MAP&&this._markers.push(s.marker(a,{icon:this._iconCurrentOffer}).addTo(this._map))}componentWillUnmount(){this._map=null}_getCoordinates(e){return e.map(e=>({lat:e.location.latitude,lng:e.location.longitude}))}_getCoordinatesWithID(e){return e.map(e=>({lat:e.location.latitude,lng:e.location.longitude,id:e.id}))}_getCurrentCityCoordinate(e){return{lat:e[0].city.location.latitude,lng:e[0].city.location.longitude,zoom:e[0].city.location.zoom}}_initiatesMap(){const{currentCityOffers:e}=this.props,t=this._getCurrentCityCoordinate(e);this._map=s.map(this._mapRef.current,{center:t,zoom:t.zoom,zoomControl:!1,marker:!0})}_resetMarkers(){void 0!==this._markers&&this._markers.forEach(e=>this._map.removeLayer(e))}render(){const{classModificator:e}=this.props;return a.createElement("section",{ref:this._mapRef,className:`map ${e}`})}}t.default=o}).call(this,r(15))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3),n=r(83),o=r(84),i=r(85).default(o.default);t.default=e=>{const{classModificator:t,currentCityOffers:r,currentSort:o,currentCity:c,handleSortChange:l,onCardHover:u,onCardLeave:d}=e,m=r.length;return a.createElement("section",{className:`places ${t}`},t===s.ClassModificator.CITIES_PLACES&&a.createElement(a.Fragment,null,a.createElement("h2",{className:"visually-hidden"},"Places"),a.createElement("b",{className:"places__found"},m," places to stay in ",c),a.createElement(i,{currentSort:o,handleSortChange:l}),a.createElement(n.default,{classModificator:s.ClassModificator.CITIES_PLACES_LIST,currentCityOffers:r,currentSort:o,onCardHover:u,onCardLeave:d})),t===s.ClassModificator.NEAR_PLACES&&a.createElement(a.Fragment,null,a.createElement("h2",{className:"near-places__title"},"Other places in the neighbourhood"),a.createElement(n.default,{classModificator:s.ClassModificator.NEAR_PLACES_LIST,currentCityOffers:r,currentSort:o,onCardHover:u,onCardLeave:d})))}},,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(23),n=r(13),o=r(8),i=r(61),c=r(62),l=r(63),u=r(97),d=r(21),m=r(98),p=r(7),_=m.createAPI(()=>{f.dispatch(p.ActionCreator.requireAuthorization(p.AuthorizationStatus.NO_AUTH))}),f=n.createStore(u.default,i.composeWithDevTools(n.applyMiddleware(c.default.withExtraArgument(_))));f.dispatch(d.Operation.loadOffers()),f.dispatch(p.Operation.checkAuth()),s.render(a.createElement(o.Provider,{store:f},a.createElement(l.default,null)),document.querySelector("#root"))},,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(8),n=r(9),o=r(20),i=r(7),c=r(16),l=r(65),u=r(66),d=r(24),m=r(12),p=r(25),_=r(67),f=r(3),h=r(68),E=r(70),v=r(76),O=r(80),g=r(87),C=r(93),y=r(94),S=r(95),R=r(96),A=h.default(E.default),N=h.default(v.default),T=h.default(O.default),b=h.default(g.default),P=e=>{const{authStatus:t,currentCity:r,currentSort:s,currentCityOffers:o,focusOffer:c,locations:l,loadStatus:u,offers:d,onCardHover:m,onCardLeave:p,onResetError:_,responseStatus:h,signIn:E}=e,v=u,O=0===d.length,g=t===i.AuthorizationStatus.AUTH;return a.createElement(n.BrowserRouter,{basename:"/959581-six-cities-3"},a.createElement(n.Switch,null,a.createElement(C.default,{exact:!0,path:f.AppRoute.ROOT,component:v&&O?a.createElement(S.default,null):a.createElement(T,{currentCity:r,currentCityOffers:o,currentSort:s,focusOffer:c,locations:l,onCardHover:m,onCardLeave:p,onResetError:_,responseStatus:h})}),a.createElement(C.default,{exact:!0,path:f.AppRoute.LOGIN,component:a.createElement(N,{currentCity:r,isAuth:g,onResetError:_,responseStatus:h,signIn:E})}),a.createElement(C.default,{exact:!0,path:f.AppRoute.OFFER,component:a.createElement(b,{currentSort:s,focusOffer:c,onCardHover:m,onCardLeave:p,onResetError:_,responseStatus:h})}),a.createElement(y.default,{exact:!0,path:f.AppRoute.FAVORITE,render:()=>a.createElement(A,{onCardHover:m,onCardLeave:p,onResetError:_,responseStatus:h,currentCity:r})}),a.createElement(C.default,{exact:!0,path:f.AppRoute.NOT_FOUND,component:a.createElement(R.default,null)})))};t.App=P;t.default=s.connect(e=>({authStatus:m.getAuthorizationStatus(e),focusOffer:p.getFocusOffer(e),currentCity:u.getCurrentCity(e),currentSort:_.getCurrentSort(e),currentCityOffers:d.getOffersCurrentCity(e),offers:d.getOffers(e),locations:d.getLocations(e),loadStatus:d.getLoadStatus(e),responseStatus:l.getResponseStatusCode(e)}),e=>({onCardHover(t){e(o.ActionCreator.setFocusOffer(t))},onCardLeave(){e(o.ActionCreator.resetFocusOffer())},onResetError(){e(c.ActionCreator.resetResponseStatusCode())},signIn(t){e(i.Operation.signIn(t))}}))(P)},,function(e,t,r){"use strict";r.r(t),r.d(t,"getResponseStatusCode",(function(){return s}));const a=r(1).a.RESPONSE,s=e=>e[a].responseStatusCode},function(e,t,r){"use strict";r.r(t),r.d(t,"getCurrentCity",(function(){return s}));var a=r(1);const s=e=>e[a.a.CITY].currentCity},function(e,t,r){"use strict";r.r(t),r.d(t,"getCurrentSort",(function(){return s}));const a=r(1).a.SORT,s=e=>e[a].currentSort},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(69);t.default=e=>{class t extends a.PureComponent{_isErrorCode(e){if(null===e)return!1;return"2"!==e.toString()[0]}render(){const{onResetError:t,responseStatus:r}=this.props;return a.createElement(a.Fragment,null,this._isErrorCode(r)&&a.createElement(s.default,{errorCode:r,onResetError:t}),this._isErrorCode(r)||"",a.createElement(e,Object.assign({},this.props)))}}return t}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s={errorMessage:{position:"fixed",top:"5%",right:"50%",left:"50%",zIndex:50,width:"250px",color:"#ffffff",padding:"25px",backgroundColor:"rgba(255, 99, 71, 0.75)",borderRadius:"5px"},header:{paddingBottom:"10px"},closeButton:{position:"absolute",top:"5px",right:"5px",zIndex:10,width:"10px",height:"10px",padding:"10px",color:"#ffffff",backgroundSize:"10px",backgroundImage:`url(${e.env.PUBLIC_URL+"/img/close.svg"})`,backgroundPosition:"center",backgroundRepeat:"no-repeat"}};class n extends a.PureComponent{constructor(e){super(e),this._onEscKeyDown=this._onEscKeyDown.bind(this),this._handleMessageClose=this._handleMessageClose.bind(this)}componentDidMount(){document.addEventListener("keydown",this._onEscKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this._onEscKeyDown)}_handleMessageClose(){this.props.onResetError()}_onEscKeyDown(e){"Escape"!==e.key&&"Esc"!==e.key||this.props.onResetError()}render(){const{errorCode:e}=this.props;return a.createElement("div",{className:"error-message",style:s.errorMessage},a.createElement("div",{className:"error-message__header",style:s.header},a.createElement("b",null,"Код ошибки: ",e)),a.createElement("div",{className:"message__text"},a.createElement("p",null,"Что-то пошло не так:(")),a.createElement("button",{className:"error-message__button",style:s.closeButton,onClick:this._handleMessageClose}))}}t.default=n}).call(this,r(15))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(8),n=r(33),o=r(12),i=r(7),c=r(34),l=r(73),u=r(74);class d extends a.PureComponent{constructor(e){super(e)}_setClassModificator(){const{favorites:e}=this.props;return 0===e.length?"page page--favorites page--favorites-empty":"page page--favorites"}render(){const{authStatus:t,currentCity:r,favorites:s,favoritesLocations:n,onCardHover:o,onCardLeave:d,user:m}=this.props,p=0===s.length,_=t===i.AuthorizationStatus.AUTH;return a.createElement(c.default,{className:this._setClassModificator(),isAuth:_,user:m},a.createElement(a.Fragment,null,a.createElement("main",{className:`page__main page__main--favorites ${p?"page__main--favorites-empty":""}`},a.createElement("div",{className:"page__favorites-container container"},p&&a.createElement(l.default,null),p||a.createElement(u.default,{currentCity:r,favorites:s,favoritesLocations:n,onCardHover:o,onCardLeave:d}))),a.createElement("footer",{className:"footer container"},a.createElement("a",{className:"footer__logo-link",href:"main.html"},a.createElement("img",{className:"footer__logo",src:e.env.PUBLIC_URL+"/img/logo.svg",alt:"6 cities logo",width:"64",height:"33"})))))}}t.Favorites=d;t.default=s.connect(e=>({authStatus:o.getAuthorizationStatus(e),favorites:n.getFavorites(e),favoritesLocations:n.getFavoritesLocations(e),user:o.getUser(e)}))(d)}).call(this,r(15))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(3),o=r(72);t.default=e=>{const{isAuth:t,user:r}=e;return a.createElement("header",{className:"header"},a.createElement("div",{className:"container"},a.createElement("div",{className:"header__wrapper"},a.createElement("div",{className:"header__left"},a.createElement(o.default,null)),a.createElement("nav",{className:"header__nav"},a.createElement("ul",{className:"header__nav-list"},a.createElement("li",{className:"header__nav-item user"},t&&a.createElement(s.Link,{className:"header__nav-link header__nav-link--profile",to:n.AppRoute.FAVORITE},a.createElement("div",{className:"header__avatar-wrapper user__avatar-wrapper",style:{backgroundImage:`url(${n.SITE_URL}${r.avatarUrl})`}}),a.createElement("span",{className:"header__user-name user__name"},r.email)),t||a.createElement(s.Link,{to:n.AppRoute.LOGIN,className:"header__nav-link header__nav-link--profile"},a.createElement("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),a.createElement("span",{className:"header__user-name user__name"},"Sign in"))))))))}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(3);t.default=()=>a.createElement(s.Link,{to:n.AppRoute.ROOT,className:"header__logo-link header__logo-link--active"},a.createElement("img",{className:"header__logo",src:e.env.PUBLIC_URL+"/img/logo.svg",alt:"6 cities logo",width:"81",height:"41"}))}).call(this,r(15))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=()=>a.createElement("section",{className:"favorites favorites--empty"},a.createElement("h1",{className:"visually-hidden"},"Favorites (empty)"),a.createElement("div",{className:"favorites__status-wrapper"},a.createElement("b",{className:"favorites__status"},"Nothing yet saved."),a.createElement("p",{className:"favorites__status-description"},"Save properties to narrow down search or plan yor future trips.")))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(2),n=r(75);class o extends a.PureComponent{constructor(e){super(e)}_getOffersForLocation(e,t){return s.getUniqueArray(e.filter(e=>e.city.name===t))}render(){const{currentCity:e,favorites:t,favoritesLocations:r,onCardHover:s,onCardLeave:o}=this.props;return a.createElement("section",{className:"favorites"},a.createElement("h1",{className:"favorites__title"},"Saved listing"),a.createElement("ul",{className:"favorites__list"},r.map((i,c)=>a.createElement(n.default,{city:i,key:i,isCurrentCity:e===i,offers:this._getOffersForLocation(t,r[c]),onCardHover:s,onCardLeave:o}))))}}t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3),n=r(35),o=r(38).default(n.default);t.default=e=>{const{city:t,offers:r,isCurrentCity:n,onCardHover:i,onCardLeave:c}=e;return a.createElement("li",{className:"favorites__locations-items"},a.createElement("div",{className:`favorites__locations locations ${n?"locations--current":""}`},a.createElement("div",{className:"locations__item"},a.createElement("a",{className:"locations__item-link",href:"#"},a.createElement("span",null,t)))),a.createElement("div",{className:"favorites__places"},r.map(e=>a.createElement(o,{key:e.id,classModificator:s.ClassModificator.FAVORITES,offer:e,onCardHover:i,onCardLeave:c}))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(3),o=r(77),i=r(78),c=o.default(i.default);t.default=e=>{const{currentCity:t,isAuth:r,signIn:o}=e;return a.createElement(a.Fragment,null,r&&a.createElement(s.Redirect,{to:n.AppRoute.ROOT}),r||a.createElement("main",{className:"page__main page__main--login"},a.createElement("div",{className:"page__login-container container"},a.createElement("section",{className:"login"},a.createElement("h1",{className:"login__title"},"Sign in"),a.createElement(c,{signIn:o})),a.createElement("section",{className:"locations locations--login locations--current"},a.createElement("div",{className:"locations__item"},a.createElement("a",{className:"locations__item-link",href:"#"},a.createElement("span",null,t)))))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=e=>{class t extends a.PureComponent{constructor(e){super(e),this.state={login:"",password:""},this._setDataUser=this._setDataUser.bind(this)}_setDataUser({currentTarget:e}){switch(e.name){case"email":this.setState({login:e.value});break;case"password":this.setState({password:e.value})}}render(){const{login:t,password:r}=this.state;return a.createElement(e,Object.assign({},this.props,{login:t,password:r,onChange:this._setDataUser}))}}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3),n=r(79);class o extends a.PureComponent{constructor(e){super(e),this._handleSubmit=this._handleSubmit.bind(this)}_handleSubmit(e){e.preventDefault();const{login:t,password:r}=this.props;this.props.signIn({login:t,password:r})}render(){const{login:e,password:t,onChange:r}=this.props;return a.createElement("form",{className:"login__form form",action:"#",method:"post",onSubmit:this._handleSubmit},a.createElement("div",{className:"login__input-wrapper form__input-wrapper"},a.createElement("label",{className:"visually-hidden"},"E-mail"),a.createElement(n.default,{onChange:r,type:s.TypeInputLogin.EMAIL,value:e})),a.createElement("div",{className:"login__input-wrapper form__input-wrapper"},a.createElement("label",{className:"visually-hidden"},"Password"),a.createElement(n.default,{onChange:r,type:s.TypeInputLogin.PASSWORD,value:t})),a.createElement("button",{className:"login__submit form__submit button",type:"submit"},"Sign in"))}}t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3);t.default=e=>{const{onChange:t,type:r,value:n}=e,o=r===s.TypeInputLogin.EMAIL?"Email":"Password";return a.createElement("input",{className:"login__input form__input",type:r,name:r,placeholder:o,value:n,onChange:t,required:!0})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(8),n=r(17),o=r(27),i=r(81),c=r(86);class l extends a.PureComponent{constructor(e){super(e)}render(){const{currentCityOffers:e,currentCity:t,currentSort:r,focusOffer:s,handleLocationClick:n,handleSortChange:o,locations:l,onCardHover:u,onCardLeave:d}=this.props;return 0===e.length?"":a.createElement("main",{className:"page__main page__main--index"},a.createElement("h1",{className:"visually-hidden"},"Cities"),a.createElement(c.default,{currentCity:t,handleLocationClick:n,locations:l}),a.createElement(i.default,{currentCityOffers:e,focusOffer:s,currentCity:t,currentSort:r,handleSortChange:o,onCardHover:u,onCardLeave:d}))}}t.Main=l;t.default=s.connect(null,e=>({handleLocationClick(t){e(n.ActionCreator.setCurrentCity(t))},handleSortChange(t){e(o.ActionCreator.setCurrentSort(t))}}))(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3),n=r(39),o=r(40);t.default=e=>{const{currentCityOffers:t,currentSort:r,currentCity:i,focusOffer:c,handleSortChange:l,onCardHover:u,onCardLeave:d}=e;return a.createElement("div",{className:"cities"},a.createElement("div",{className:"cities__places-container container"},a.createElement(o.default,{classModificator:s.ClassModificator.CITIES_PLACES,currentCity:i,currentCityOffers:t,currentSort:r,handleSortChange:l,onCardHover:u,onCardLeave:d}),a.createElement("div",{className:"cities__right-section"},a.createElement(n.default,{classModificator:s.ClassModificator.CITIES_MAP,currentCityOffers:t,focusOffer:c}))))}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3),n=r(35),o=r(38).default(n.default);class i extends a.PureComponent{constructor(e){super(e)}_sortBy(){const{currentCityOffers:e,currentSort:t}=this.props;switch(t){case s.TypeSort.PRICE_LOW_TO_HIGH:return e.slice().sort((e,t)=>e.price-t.price);case s.TypeSort.PRICE_HIGH_TO_LOW:return e.slice().sort((e,t)=>t.price-e.price);case s.TypeSort.TOP_RATED_FIRST:return e.slice().sort((e,t)=>t.rating-e.rating);default:return e}}render(){const{classModificator:e,onCardHover:t,onCardLeave:r}=this.props,n=this._sortBy().map(e=>a.createElement(o,{classModificator:s.ClassModificator.CITIES,key:`${e.id}`,offer:e,onCardHover:t,onCardLeave:r}));return a.createElement("div",{className:`places__list ${e}`},n)}}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3);t.default=e=>{const{currentSort:t,handleSortChange:r,isActive:n,onToggleClick:o}=e;return a.createElement("form",{className:"places__sorting",action:"#",method:"get",onClick:o},a.createElement("span",{className:"places__sorting-caption"},"Sort by "),a.createElement("span",{className:"places__sorting-type",tabIndex:0},t,a.createElement("svg",{className:"places__sorting-arrow",width:"7",height:"4"},a.createElement("use",{xlinkHref:"#icon-arrow-select"}))),a.createElement("ul",{className:`places__options places__options--custom ${n?"places__options--opened":""}`},s.SORTING.map(e=>e!==t&&a.createElement("li",{className:"places__option",key:e,tabIndex:0,onClick:()=>{r(e)}},e))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=e=>{class t extends a.PureComponent{constructor(e){super(e),this.state={isActive:!1},this._handleToggleClick=this._handleToggleClick.bind(this)}_handleToggleClick(){this.setState(e=>({isActive:!e.isActive}))}render(){const{isActive:t}=this.state;return a.createElement(e,Object.assign({},this.props,{isActive:t,onToggleClick:this._handleToggleClick}))}}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=e=>{const{currentCity:t,locations:r,handleLocationClick:s}=e;return a.createElement("div",{className:"tabs"},a.createElement("section",{className:"locations container"},a.createElement("ul",{className:"locations__list tabs__list"},r.map(e=>a.createElement("li",{className:"locations__item",key:e,onClick:()=>{s(e)}},a.createElement("a",{className:`locations__item-link tabs__item ${e===t?"tabs__item--active":""}`,href:"#"},a.createElement("span",null,e)))))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(8),n=r(3),o=r(24),i=r(25),c=r(12),l=r(21),u=r(7),d=r(88),m=r(39),p=r(40),_=r(36),f=r(37);class h extends a.PureComponent{componentDidMount(){this.props.onLoadDataProperty()}componentDidUpdate({offersNearby:e}){e||this.props.onLoadDataProperty()}render(){const{activeOffer:e,authStatus:t,currentSort:r,comments:s,countComments:o,focusOffer:i,offersNearby:c,onCardHover:l,onCommentSubmit:h,onCardLeave:E,responseStatus:v}=this.props;if(0===c.length||null===e)return"";const{bedrooms:O,goods:g,host:C,id:y,images:S,isPremium:R,maxAdults:A,price:N,rating:T,title:b,type:P,location:M}=e,F={lat:M.latitude,lng:M.longitude},w=t===u.AuthorizationStatus.AUTH;return a.createElement("main",{className:"page__main page__main--property"},a.createElement("section",{className:"property"},a.createElement("div",{className:"property__gallery-container container"},a.createElement("div",{className:"property__gallery"},S.map((e,t)=>a.createElement("div",{key:`${t}${e}`,className:"property__image-wrapper"},a.createElement("img",{className:"property__image",src:e,alt:"Photo studio"}))))),a.createElement("div",{className:"property__container container"},a.createElement("div",{className:"property__wrapper"},R&&a.createElement("div",{className:"property__mark"},a.createElement("span",null,"Premium")),a.createElement("div",{className:"property__name-wrapper"},a.createElement("h1",{className:"property__name"},b),a.createElement(_.default,{classModificator:n.ClassModificator.PROPERTY,id:y,height:33,width:31})),a.createElement(f.default,{classModificator:n.ClassModificator.PROPERTY,rating:T}),a.createElement("ul",{className:"property__features"},a.createElement("li",{className:"property__feature property__feature--entire"},P),a.createElement("li",{className:"property__feature property__feature--bedrooms"},O," Bedrooms"),a.createElement("li",{className:"property__feature property__feature--adults"},"Max ",A," adults")),a.createElement("div",{className:"property__price"},a.createElement("b",{className:"property__price-value"},"€",N),a.createElement("span",{className:"property__price-text"}," night")),a.createElement("div",{className:"property__inside"},a.createElement("h2",{className:"property__inside-title"},"What's inside"),a.createElement("ul",{className:"property__inside-list"},g.map(e=>a.createElement("li",{key:e,className:"property__inside-item"},e)))),a.createElement("div",{className:"property__host"},a.createElement("h2",{className:"property__host-title"},"Meet the host"),a.createElement("div",{className:"property__host-user user"},a.createElement("div",{className:`property__avatar-wrapper ${C.isPro?"property__avatar-wrapper--pro":""} user__avatar-wrapper`},a.createElement("img",{className:"property__avatar user__avatar",src:`../${C.avatarUrl}`,width:"74",height:"74",alt:"Host avatar"})),a.createElement("span",{className:"property__user-name"},C.name)),a.createElement("div",{className:"property__description"},a.createElement("p",{className:"property__text"}))),a.createElement(d.default,{comments:s,countComments:o,isAuth:w,onCommentSubmit:h,responseStatus:v}))),a.createElement(m.default,{classModificator:n.ClassModificator.PROPERTY_MAP,currentCityOffers:c,focusOffer:i,currentOfferCoordinate:F})),a.createElement("div",{className:"container"},a.createElement(p.default,{classModificator:n.ClassModificator.NEAR_PLACES,currentCityOffers:c,currentSort:r,onCardHover:l,onCardLeave:E})))}}t.Property=h;t.default=s.connect(e=>({activeOffer:i.getActiveOffer(e),authStatus:c.getAuthorizationStatus(e),comments:o.getCommentsByShow(e),countComments:o.getCountComments(e),offersNearby:o.getOffersNearby(e)}),e=>({onCommentSubmit(t){e(l.Operation.uploadComments(t))},onLoadDataProperty(){e(l.Operation.loadComments()),e(l.Operation.loadOffersNearby())}}))(h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(89),n=r(91),o=r(92).default(n.default);t.default=e=>{const{comments:t,countComments:r,isAuth:n,onCommentSubmit:i,responseStatus:c}=e;return a.createElement("section",{className:"property__reviews reviews"},a.createElement("h2",{className:"reviews__title"},"Reviews ·",a.createElement("span",{className:"reviews__amount"},r)),a.createElement(s.default,{comments:t}),n&&a.createElement(o,{countComments:r,onCommentSubmit:i,responseStatus:c}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(90);t.default=e=>{const{comments:t}=e;return a.createElement("ul",{className:"reviews__list"},t.slice().reverse().map(e=>a.createElement(s.default,{key:`${e.id}`,comment:e})))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3);class n extends a.PureComponent{constructor(e){super(e)}_getDate(e){const t={month:"long",year:"numeric"};return`${new Date(e).toLocaleString("en-EN",t)}`}render(){const{comment:e}=this.props,{date:t,rating:r,user:n}=e;return a.createElement("li",{className:"reviews__item"},a.createElement("div",{className:"reviews__user user"},a.createElement("div",{className:"reviews__avatar-wrapper user__avatar-wrapper"},a.createElement("img",{className:"reviews__avatar user__avatar",src:n.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})),a.createElement("span",{className:"reviews__user-name"},n.name)),a.createElement("div",{className:"reviews__info"},a.createElement("div",{className:"reviews__rating rating"},a.createElement("div",{className:"reviews__stars rating__stars"},a.createElement("span",{style:{width:`${s.ONE_STAR*r}%`}}),a.createElement("span",{className:"visually-hidden"},"Rating"))),a.createElement("p",{className:"reviews__text"},e.comment),a.createElement("time",{className:"reviews__time",dateTime:t},this._getDate(t))))}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(3);class n extends a.PureComponent{constructor(e){super(e),this._submitButtonRef=a.createRef(),this._textAreaRef=a.createRef(),this._setDisabledOnClick=this._setDisabledOnClick.bind(this),this._checkTextAreaDisabled=this._checkTextAreaDisabled.bind(this)}componentDidMount(){this._submitButtonRef.current.disabled=!0}componentDidUpdate(e){this._checkTextAreaDisabled(e),this._checkSubmitDisabled()}_setDisabledOnClick(){this._submitButtonRef.current.disabled=!0,this._textAreaRef.current.disabled=!0}_checkSubmitDisabled(){const{rating:e,comment:t}=this.props;0===e||t.length<=50||t.length>=300?this._submitButtonRef.current.disabled=!0:this._submitButtonRef.current.disabled=!1}_checkTextAreaDisabled(e){const{responseStatus:t,countComments:r}=e;(t===s.ResponseStatus.STATUS_OK||null===t)&&r<this.props.countComments&&(this._textAreaRef.current.disabled=!1)}render(){const{comment:e,onChange:t,onSubmit:r,rating:n}=this.props;return a.createElement("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:r},a.createElement("label",{className:"reviews__label form__label",htmlFor:"review"},"Your review"),a.createElement("div",{className:"reviews__rating-form form__rating"},s.STARS.map(e=>a.createElement(a.Fragment,{key:`${e}-stars`},a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:e,id:`${e}-stars`,type:"radio",checked:n===e,onChange:t}),a.createElement("label",{htmlFor:`${e}-stars`,className:"reviews__rating-label form__rating-label",title:"perfect"},a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},a.createElement("use",{xlinkHref:"#icon-star"})))))),a.createElement("textarea",{className:"reviews__textarea form__textarea",id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",value:e,onChange:t,ref:this._textAreaRef}),a.createElement("div",{className:"reviews__button-wrapper"},a.createElement("p",{className:"reviews__help"},"To submit review please make sure to set",a.createElement("span",{className:"reviews__star"},"rating"),"and describe your stay with at least",a.createElement("b",{className:"reviews__text-amount"},"50 characters"),"."),a.createElement("button",{className:"reviews__submit form__submit button",type:"submit",onClick:this._setDisabledOnClick,ref:this._submitButtonRef},"Submit")))}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=e=>{class t extends a.PureComponent{constructor(e){super(e),this.state={rating:0,comment:""},this._handleChange=this._handleChange.bind(this),this._handleSubmit=this._handleSubmit.bind(this)}componentDidUpdate(e){e.countComments<this.props.countComments&&this.setState({rating:0,comment:""})}_handleChange({currentTarget:e}){switch(e.name){case"rating":return void this.setState({rating:parseInt(e.value,10)});case"review":this.setState({comment:e.value})}}_handleSubmit(e){e.preventDefault();const{rating:t,comment:r}=this.state,{onCommentSubmit:a}=this.props;a({rating:t,text:r})}render(){const{comment:t,rating:r}=this.state;return a.createElement(e,Object.assign({},this.props,{comment:t,onChange:this._handleChange,onSubmit:this._handleSubmit,rating:r}))}}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(8),o=r(12),i=r(24),c=r(25),l=r(7),u=r(3),d=r(20),m=r(34);class p extends a.PureComponent{constructor(e){super(e)}_setInitialActiveOffer(e){const{initialOffers:t}=this.props,r=t.find(t=>t.id===e);this.props.onSetActiveOffer(r)}_checkCorrectOfferId(e){const{initialOffers:t}=this.props;return t.length<=e||isNaN(e)}render(){const{activeOffer:e,authStatus:t,component:r,exact:n,loadStatus:o,path:i,user:c}=this.props;if(!0!==o)return"";const d=t===l.AuthorizationStatus.AUTH;let p;switch(i){case u.AppRoute.ROOT:p=u.ClassModificator.PAGE_MAIN;break;case u.AppRoute.LOGIN:p=u.ClassModificator.PAGE_LOGIN;break;case u.AppRoute.OFFER:p=u.ClassModificator.PAGE_PROPERTY;break;default:p=u.ClassModificator.PAGE_MAIN}return a.createElement(s.Route,{path:i,exact:n,render:t=>{if(i===u.AppRoute.OFFER){const r=parseInt(t.match.params.id,10);if(this._checkCorrectOfferId(r))return a.createElement(s.Redirect,{to:{pathname:u.AppRoute.NOT_FOUND,state:{from:t.location}}});null!==e&&e.id===r||this._setInitialActiveOffer(r)}return a.createElement(m.default,{className:p,isAuth:d,user:c},r)}})}}t.RouteWithPage=p;t.default=n.connect(e=>({authStatus:o.getAuthorizationStatus(e),activeOffer:c.getActiveOffer(e),initialOffers:i.getOffers(e),loadStatus:i.getLoadStatus(e),user:o.getUser(e)}),e=>({onSetActiveOffer(t){e(d.ActionCreator.setActiveOffer(t))}}))(p)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0),s=r(9),n=r(8),o=r(3),i=r(7),c=r(12),l=e=>{const{authStatus:t,exact:r,path:n,render:c}=e,l=t===i.AuthorizationStatus.AUTH;return a.createElement(s.Route,{path:n,exact:r,render:e=>l?c():a.createElement(s.Redirect,{to:{pathname:o.AppRoute.LOGIN,state:{from:e.location}}})})};t.PrivateRoute=l;t.default=n.connect(e=>({authStatus:c.getAuthorizationStatus(e)}))(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=()=>a.createElement("main",{className:"page__main page__main--index page__main--index-empty"},a.createElement("div",{className:"cities"},a.createElement("div",{className:"cities__places-container cities__places-container--empty container"},a.createElement("section",{className:"cities__no-places"},a.createElement("div",{className:"cities__status-wrapper tabs__content"},a.createElement("b",{className:"cities__status"},"No places to stay available"),a.createElement("p",{className:"cities__status-description"},"We could not find any property available at the moment"))),a.createElement("div",{className:"cities__right-section"}))))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.default=()=>a.createElement("main",{className:"page__main page__main--index page__main--index-empty"},a.createElement("div",{className:"cities"},a.createElement("div",{className:"cities__places-container cities__places-container--empty container"},a.createElement("section",{className:"cities__no-places"},a.createElement("div",{className:"cities__status-wrapper tabs__content"},a.createElement("b",{className:"cities__status"},"Page not found"),a.createElement("p",{className:"cities__status-description"},"Maybe you were wrong when entering link"))),a.createElement("div",{className:"cities__right-section"}))))},function(e,t,r){"use strict";r.r(t);var a=r(13),s=r(21),n=r(27),o=r(17),i=r(20),c=r(7),l=r(16),u=r(26),d=r(1);t.default=Object(a.combineReducers)({[d.a.DATA]:s.reducer,[d.a.SORT]:n.reducer,[d.a.OFFER]:i.reducer,[d.a.CITY]:o.reducer,[d.a.USER]:c.reducer,[d.a.RESPONSE]:l.reducer,[d.a.FAVORITE]:u.reducer})},function(e,t,r){"use strict";r.r(t),r.d(t,"createAPI",(function(){return o}));var a=r(51),s=r.n(a),n=r(3);const o=e=>{const t=s.a.create({baseURL:"https://htmlacademy-react-3.appspot.com/six-cities",timeout:5e3,withCredentials:!0});return t.interceptors.response.use(e=>e,t=>{const{response:r}=t;if(r.status===n.ResponseStatus.UNAUTHORIZED)throw e(),t;throw t}),t}}]);